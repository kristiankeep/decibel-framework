<?php
namespace tests\app\decibel\model;

use app\decibel\model\DLightModel_Definition;
use app\decibel\model\field\DArrayField;
use app\decibel\model\field\DTextField;
use app\decibel\test\DTestCase;

class TestDLightModel_Definition_InvalidAddFieldFunctionCall extends DLightModel_Definition
{
    public function __construct($qualifiedName)
    {
        $this->addField(new DTextField('test', 'Test'));
        parent::__construct($qualifiedName);
    }
}

/**
 * Test class for DLightModel_Definition.
 * Generated by Decibel on 2012-04-12 at 09:08:46.
 */
class DLightModel_DefinitionTest extends DTestCase
{
    /**
     * @covers app\decibel\model\DLightModel_Definition::__construct
     * @todo   Assert default fields.
     */
    public function test__construct()
    {
        $definition = new TestLightModel_Definition(TestLightModel::class);
        $this->assertInstanceOf(TestLightModel_Definition::class, $definition);
    }

    /**
     * @covers app\decibel\model\DLightModel_Definition::addField
     */
    public function testaddField()
    {
        $definition = new TestLightModel_Definition('tests\\app\\decibel\\model\\TestLightModel');
        $field = new DTextField('test', 'Test');
        $definition->addField($field);
        $this->assertSame($field, $definition->getField('test'));
        $this->assertSame('tests\\app\\decibel\\model\\TestLightModel', $field->getOwner());
    }

    /**
     * @covers app\decibel\model\DLightModel_Definition::addField
     * @expectedException app\decibel\model\debug\DUnsupportedFieldTypeException
     */
    public function testaddField_invalid()
    {
        $definition = new TestLightModel_Definition('tests\\app\\decibel\\model\\TestLightModel');
        $field = new DArrayField('test', 'Test');
        $definition->addField($field);
    }

    /**
     * @covers app\decibel\model\DLightModel_Definition::addField
     * @expectedException app\decibel\debug\DInvalidMethodCallException
     */
    public function testaddField_invalidCall()
    {
        $this->markTestIncomplete(
            'This test has not been implemented yet.'
        );

        new TestDLightModel_Definition_InvalidAddFieldFunctionCall('tests\\app\\decibel\\model\\TestDLightModel_Definition_InvalidAddFieldFunctionCall');
    }
}
